<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;800&display=swap" rel=stylesheet><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://ocm.software/main.95e39a9ce1ce5fb3cd4b35cc44704c26d38ee121edd0be86e81201623bdf3f597c708ecd716ceb53a9755d8a3fff52c1449a13e5ae48d33fbb4c91de33eeb94d.css integrity="sha512-leOanOHOX7PNSzXMRHBMJtOO4SHt0L6G6BIBYjvfP1l8cI7NcWzrU6l1XYo//1LBRJoT5a5I0z+7TJHeM+65TQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><style>@import 'https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;800&display=swap'</style><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Getting Started with Flux & OCM | Open Component Model</title><meta name=description content="Deploying OCM components using Flux"><link rel=canonical href=https://ocm.software/docs/guides/getting-started-with-ocm-flux/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Getting Started with Flux & OCM"><meta property="og:description" content="Deploying OCM components using Flux"><meta property="og:url" content="https://ocm.software/docs/guides/getting-started-with-ocm-flux/"><meta property="og:site_name" content="Open Component Model"><meta property="article:published_time" content="2022-11-23T10:00:00+00:00"><meta property="article:modified_time" content="2022-11-23T10:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="Getting Started with Flux & OCM"><meta name=twitter:description content="Deploying OCM components using Flux"><meta name=twitter:card content="summary"><meta name=twitter:image:alt content="Getting Started with Flux & OCM"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://ocm.software/#/schema/organization/1","name":"OCM","url":"https://ocm.software/","sameAs":["https://github.com/open-component-model"],"logo":{"@type":"ImageObject","@id":"https://ocm.software/#/schema/image/1","url":"https://ocm.software/","width":512,"height":512,"caption":"OCM"},"image":{"@id":"https://ocm.software/#/schema/image/1"}},{"@type":"WebSite","@id":"https://ocm.software/#/schema/website/1","url":"https://ocm.software/","name":"Open Component Model","description":"","publisher":{"@id":"https://ocm.software/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://ocm.software/docs/guides/getting-started-with-ocm-flux/","url":"https://ocm.software/docs/guides/getting-started-with-ocm-flux/","name":"Getting Started with Flux \u0026 OCM","description":"Deploying OCM components using Flux","isPartOf":{"@id":"https://ocm.software/#/schema/website/1"},"about":{"@id":"https://ocm.software/#/schema/organization/1"},"datePublished":"2022-11-23T10:00:00CET","dateModified":"2022-11-23T10:00:00CET","breadcrumb":{"@id":"https://ocm.software/docs/guides/getting-started-with-ocm-flux/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://ocm.software/docs/guides/getting-started-with-ocm-flux/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://ocm.software/docs/guides/getting-started-with-ocm-flux/"]}]},{"@type":"BreadcrumbList","@id":"https://ocm.software/docs/guides/getting-started-with-ocm-flux/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://ocm.software","url":"https://ocm.software","name":"Home"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://ocm.software/docs/","url":"https://ocm.software/docs/","name":"Docs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://ocm.software/docs/guides/","url":"https://ocm.software/docs/guides/","name":"Guides"}},{"@type":"ListItem","position":5,"item":{"@id":"https://ocm.software/docs/guides/getting-started-with-ocm-flux/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://ocm.software/#/schema/article/1","headline":"Getting Started with Flux \u0026 OCM","description":"Deploying OCM components using Flux","isPartOf":{"@id":"https://ocm.software/docs/guides/getting-started-with-ocm-flux/"},"mainEntityOfPage":{"@id":"https://ocm.software/docs/guides/getting-started-with-ocm-flux/"},"datePublished":"2022-11-23T10:00:00CET","dateModified":"2022-11-23T10:00:00CET","author":{"@id":"https://ocm.software/#/schema/person/2"},"publisher":{"@id":"https://ocm.software/#/schema/organization/1"},"image":{"@id":"https://ocm.software/docs/guides/getting-started-with-ocm-flux/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://ocm.software/#/schema/person/2","name":"","sameAs":[]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://ocm.software/docs/guides/getting-started-with-ocm-flux/#/schema/image/2","url":null,"contentUrl":null,"caption":"Getting Started with Flux \u0026 OCM"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://ocm.software/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://ocm.software/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://ocm.software/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://ocm.software/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://ocm.software/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://ocm.software/site.webmanifest></head><body class="docs single"><div class=sticky-top><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/ aria-label="Open Component Model"><img src=/images/logo-horizontal-white-text.png alt="Open Component Model Logo" class=header-logo></a>
<button class="btn btn-link order-0 ms-auto d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasExample aria-controls=offcanvasExample><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasExample aria-labelledby=offcanvasExampleLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasExampleLabel>Browse docs</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label=Close></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><h3 class="h6 text-capitalize mt-1 mb-1">Overview</h3><hr class="mt-1 mb-1"><ul class="list-unstyled ms-2 mt-2 mb-0"><li><a class=docs-link href=https://ocm.software/docs/context/>Context</a></li><li><a class=docs-link href=https://ocm.software/docs/scope/>Scope</a></li><li><a class=docs-link href=https://ocm.software/docs/installation/>Installation</a></li><li><a class=docs-link href=https://ocm.software/docs/contributing/>Contributing</a></li></ul><a class="docs-link active" href=https://ocm.software/docs/guides/><h3 class="h6 text-capitalize mt-1 mb-1">Guides</h3></a><hr class="mt-1 mb-1"><ul class="list-unstyled mb-0"><li class=ms-2><a class=docs-link href=https://ocm.software/docs/guides/structuring-software-with-ocm/>Structuring Software with OCM</a></li><li class=ms-2><a class="docs-link active" href=https://ocm.software/docs/guides/getting-started-with-ocm-flux/>Getting Started with Flux & OCM</a></li></ul><a class=docs-link href=https://ocm.software/docs/component-descriptors/><h3 class="h6 text-capitalize mt-1 mb-1">Component Descriptors</h3></a><hr class="mt-1 mb-1"><ul class="list-unstyled mb-0"><li class=ms-2><a class=docs-link href=https://ocm.software/docs/component-descriptors/version-3/>Version 3</a></li><li class=ms-2><a class=docs-link href=https://ocm.software/docs/component-descriptors/version-2/>Version 2 (legacy)</a></li></ul><a class=docs-link href=https://ocm.software/docs/cli/><h3 class="h6 text-capitalize mt-1 mb-1">Command Line Client</h3></a><hr class="mt-1 mb-1"><ul class="list-unstyled mb-0"><li><a class=docs-link href=https://ocm.software/docs/cli/add/><h4 class="h6 text-muted ms-1 mt-2 mb-1">add</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/add/componentversions/>componentversions</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/references/>references</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/resource-configuration/>resource-configuration</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/resources/>resources</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/source-configuration/>source-configuration</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/sources/>sources</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/clean/><h4 class="h6 text-muted ms-1 mt-2 mb-1">clean</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/clean/cache/>cache</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/create/><h4 class="h6 text-muted ms-1 mt-2 mb-1">create</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/create/componentarchive/>componentarchive</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/create/rsakeypair/>rsakeypair</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/create/transportarchive/>transportarchive</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/describe/><h4 class="h6 text-muted ms-1 mt-2 mb-1">describe</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/describe/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/describe/plugins/>plugins</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/download/><h4 class="h6 text-muted ms-1 mt-2 mb-1">download</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/download/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/download/componentversions/>componentversions</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/download/resources/>resources</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/get/><h4 class="h6 text-muted ms-1 mt-2 mb-1">get</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/get/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/componentversions/>componentversions</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/credentials/>credentials</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/plugins/>plugins</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/references/>references</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/resources/>resources</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/sources/>sources</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/show/><h4 class="h6 text-muted ms-1 mt-2 mb-1">show</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/show/tags/>tags</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/show/versions/>versions</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/sign/><h4 class="h6 text-muted ms-1 mt-2 mb-1">sign</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/sign/componentversions/>componentversions</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/><h4 class="h6 text-muted ms-1 mt-2 mb-1">transfer</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/commontransportarchive/>commontransportarchive</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/componentarchive/>componentarchive</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/componentversions/>componentversions</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/verify/><h4 class="h6 text-muted ms-1 mt-2 mb-1">verify</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/verify/componentversions/>componentversions</a></li></ul></ul></nav></aside></div></div><button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a href=/>Open Component Model</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0 align-self-end"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/docs/context>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/spec/>Spec</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/project/about>Project</a></li></ul><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/open-component-model><svg width="36" height="36" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59C5.87 15.66 6.02 15.42 6.02 15.21 6.02 15.02 6.01 14.39 6.01 13.72 4 14.09 3.48 13.23 3.32 12.78 3.23 12.55 2.84 11.84 2.5 11.65 2.22 11.5 1.82 11.13 2.49 11.12 3.12 11.11 3.57 11.7 3.72 11.94 4.44 13.15 5.59 12.81 6.05 12.6 6.12 12.08 6.33 11.73 6.56 11.53 4.78 11.33 2.92 10.64 2.92 7.58c0-.87.31-1.59.82-2.15C3.66 5.23 3.38 4.41 3.82 3.31c0 0 .67-.21 2.2.82C6.66 3.95 7.34 3.86 8.02 3.86S9.38 3.95 10.02 4.13c1.53-1.04 2.2-.82 2.2-.82C12.66 4.41 12.38 5.23 12.3 5.43 12.81 5.99 13.12 6.7 13.12 7.58c0 3.07-1.87 3.75-3.65 3.95C9.76 11.78 10.01 12.26 10.01 13.01 10.01 14.08 10 14.94 10 15.21 10 15.42 10.15 15.67 10.55 15.59 13.71 14.53 16 11.53 16 8c0-4.42-3.58-8-8-8z" fill="#f3f3f3"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-capitalize mt-1 mb-1">Overview</h3><hr class="mt-1 mb-1"><ul class="list-unstyled ms-2 mt-2 mb-0"><li><a class=docs-link href=https://ocm.software/docs/context/>Context</a></li><li><a class=docs-link href=https://ocm.software/docs/scope/>Scope</a></li><li><a class=docs-link href=https://ocm.software/docs/installation/>Installation</a></li><li><a class=docs-link href=https://ocm.software/docs/contributing/>Contributing</a></li></ul><a class="docs-link active" href=https://ocm.software/docs/guides/><h3 class="h6 text-capitalize mt-1 mb-1">Guides</h3></a><hr class="mt-1 mb-1"><ul class="list-unstyled mb-0"><li class=ms-2><a class=docs-link href=https://ocm.software/docs/guides/structuring-software-with-ocm/>Structuring Software with OCM</a></li><li class=ms-2><a class="docs-link active" href=https://ocm.software/docs/guides/getting-started-with-ocm-flux/>Getting Started with Flux & OCM</a></li></ul><a class=docs-link href=https://ocm.software/docs/component-descriptors/><h3 class="h6 text-capitalize mt-1 mb-1">Component Descriptors</h3></a><hr class="mt-1 mb-1"><ul class="list-unstyled mb-0"><li class=ms-2><a class=docs-link href=https://ocm.software/docs/component-descriptors/version-3/>Version 3</a></li><li class=ms-2><a class=docs-link href=https://ocm.software/docs/component-descriptors/version-2/>Version 2 (legacy)</a></li></ul><a class=docs-link href=https://ocm.software/docs/cli/><h3 class="h6 text-capitalize mt-1 mb-1">Command Line Client</h3></a><hr class="mt-1 mb-1"><ul class="list-unstyled mb-0"><li><a class=docs-link href=https://ocm.software/docs/cli/add/><h4 class="h6 text-muted ms-1 mt-2 mb-1">add</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/add/componentversions/>componentversions</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/references/>references</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/resource-configuration/>resource-configuration</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/resources/>resources</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/source-configuration/>source-configuration</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/sources/>sources</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/clean/><h4 class="h6 text-muted ms-1 mt-2 mb-1">clean</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/clean/cache/>cache</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/create/><h4 class="h6 text-muted ms-1 mt-2 mb-1">create</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/create/componentarchive/>componentarchive</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/create/rsakeypair/>rsakeypair</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/create/transportarchive/>transportarchive</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/describe/><h4 class="h6 text-muted ms-1 mt-2 mb-1">describe</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/describe/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/describe/plugins/>plugins</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/download/><h4 class="h6 text-muted ms-1 mt-2 mb-1">download</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/download/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/download/componentversions/>componentversions</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/download/resources/>resources</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/get/><h4 class="h6 text-muted ms-1 mt-2 mb-1">get</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/get/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/componentversions/>componentversions</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/credentials/>credentials</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/plugins/>plugins</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/references/>references</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/resources/>resources</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/sources/>sources</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/show/><h4 class="h6 text-muted ms-1 mt-2 mb-1">show</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/show/tags/>tags</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/show/versions/>versions</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/sign/><h4 class="h6 text-muted ms-1 mt-2 mb-1">sign</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/sign/componentversions/>componentversions</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/><h4 class="h6 text-muted ms-1 mt-2 mb-1">transfer</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/commontransportarchive/>commontransportarchive</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/componentarchive/>componentarchive</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/componentversions/>componentversions</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/verify/><h4 class="h6 text-muted ms-1 mt-2 mb-1">verify</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/verify/componentversions/>componentversions</a></li></ul></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav id=docs-sidebar class=docs-links aria-label="Main navigation"><h3 class="h6 text-capitalize mt-1 mb-1">Overview</h3><hr class="mt-1 mb-1"><ul class="list-unstyled ms-2 mt-2 mb-0"><li><a class=docs-link href=https://ocm.software/docs/context/>Context</a></li><li><a class=docs-link href=https://ocm.software/docs/scope/>Scope</a></li><li><a class=docs-link href=https://ocm.software/docs/installation/>Installation</a></li><li><a class=docs-link href=https://ocm.software/docs/contributing/>Contributing</a></li></ul><a class="docs-link active" href=https://ocm.software/docs/guides/><h3 class="h6 text-capitalize mt-1 mb-1">Guides</h3></a><hr class="mt-1 mb-1"><ul class="list-unstyled mb-0"><li class=ms-2><a class=docs-link href=https://ocm.software/docs/guides/structuring-software-with-ocm/>Structuring Software with OCM</a></li><li class=ms-2><a class="docs-link active" href=https://ocm.software/docs/guides/getting-started-with-ocm-flux/>Getting Started with Flux & OCM</a></li></ul><a class=docs-link href=https://ocm.software/docs/component-descriptors/><h3 class="h6 text-capitalize mt-1 mb-1">Component Descriptors</h3></a><hr class="mt-1 mb-1"><ul class="list-unstyled mb-0"><li class=ms-2><a class=docs-link href=https://ocm.software/docs/component-descriptors/version-3/>Version 3</a></li><li class=ms-2><a class=docs-link href=https://ocm.software/docs/component-descriptors/version-2/>Version 2 (legacy)</a></li></ul><a class=docs-link href=https://ocm.software/docs/cli/><h3 class="h6 text-capitalize mt-1 mb-1">Command Line Client</h3></a><hr class="mt-1 mb-1"><ul class="list-unstyled mb-0"><li><a class=docs-link href=https://ocm.software/docs/cli/add/><h4 class="h6 text-muted ms-1 mt-2 mb-1">add</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/add/componentversions/>componentversions</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/references/>references</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/resource-configuration/>resource-configuration</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/resources/>resources</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/source-configuration/>source-configuration</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/add/sources/>sources</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/clean/><h4 class="h6 text-muted ms-1 mt-2 mb-1">clean</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/clean/cache/>cache</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/create/><h4 class="h6 text-muted ms-1 mt-2 mb-1">create</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/create/componentarchive/>componentarchive</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/create/rsakeypair/>rsakeypair</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/create/transportarchive/>transportarchive</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/describe/><h4 class="h6 text-muted ms-1 mt-2 mb-1">describe</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/describe/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/describe/plugins/>plugins</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/download/><h4 class="h6 text-muted ms-1 mt-2 mb-1">download</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/download/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/download/componentversions/>componentversions</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/download/resources/>resources</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/get/><h4 class="h6 text-muted ms-1 mt-2 mb-1">get</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/get/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/componentversions/>componentversions</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/credentials/>credentials</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/plugins/>plugins</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/references/>references</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/resources/>resources</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/get/sources/>sources</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/show/><h4 class="h6 text-muted ms-1 mt-2 mb-1">show</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/show/tags/>tags</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/show/versions/>versions</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/sign/><h4 class="h6 text-muted ms-1 mt-2 mb-1">sign</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/sign/componentversions/>componentversions</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/><h4 class="h6 text-muted ms-1 mt-2 mb-1">transfer</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/artifacts/>artifacts</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/commontransportarchive/>commontransportarchive</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/componentarchive/>componentarchive</a></li><li><a class=docs-link href=https://ocm.software/docs/cli/transfer/componentversions/>componentversions</a></li></ul><li><a class=docs-link href=https://ocm.software/docs/cli/verify/><h4 class="h6 text-muted ms-1 mt-2 mb-1">verify</h4></a></li><ul class="list-unstyled ms-3"><li><a class=docs-link href=https://ocm.software/docs/cli/verify/componentversions/>componentversions</a></li></ul></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#table-of-content>Table of content</a></li><li><a href=#requirements>Requirements</a></li><li><a href=#building-the-component>Building the component</a><ul><li><a href=#the-shape-of-things-to-come>The shape of things to come</a></li><li><a href=#setting-up-our-project>Setting up our project</a></li><li><a href=#adding-resources>Adding resources</a></li><li><a href=#inspecting-components>Inspecting Components</a></li></ul></li><li><a href=#shipping-the-component>Shipping the component</a><ul><li><a href=#signing>Signing</a></li><li><a href=#verification>Verification</a></li><li><a href=#transferring>Transferring</a></li></ul></li><li><a href=#deploying-the-component>Deploying the component</a><ul><li><a href=#bootstrapping-flux>Bootstrapping Flux</a></li><li><a href=#deploying-the-ocm-controller>Deploying the OCM Controller</a></li><li><a href=#reconciling-components>Reconciling Components</a></li><li><a href=#consuming-snapshots-via-flux>Consuming <code>Snapshots</code> via Flux</a></li></ul></li><li><a href=#wrapping-up>Wrapping Up</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#table-of-content>Table of content</a></li><li><a href=#requirements>Requirements</a></li><li><a href=#building-the-component>Building the component</a><ul><li><a href=#the-shape-of-things-to-come>The shape of things to come</a></li><li><a href=#setting-up-our-project>Setting up our project</a></li><li><a href=#adding-resources>Adding resources</a></li><li><a href=#inspecting-components>Inspecting Components</a></li></ul></li><li><a href=#shipping-the-component>Shipping the component</a><ul><li><a href=#signing>Signing</a></li><li><a href=#verification>Verification</a></li><li><a href=#transferring>Transferring</a></li></ul></li><li><a href=#deploying-the-component>Deploying the component</a><ul><li><a href=#bootstrapping-flux>Bootstrapping Flux</a></li><li><a href=#deploying-the-ocm-controller>Deploying the OCM Controller</a></li><li><a href=#reconciling-components>Reconciling Components</a></li><li><a href=#consuming-snapshots-via-flux>Consuming <code>Snapshots</code> via Flux</a></li></ul></li><li><a href=#wrapping-up>Wrapping Up</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Getting Started with Flux & OCM</span></h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#table-of-content>Table of content</a></li><li><a href=#requirements>Requirements</a></li><li><a href=#building-the-component>Building the component</a><ul><li><a href=#the-shape-of-things-to-come>The shape of things to come</a></li><li><a href=#setting-up-our-project>Setting up our project</a></li><li><a href=#adding-resources>Adding resources</a></li><li><a href=#inspecting-components>Inspecting Components</a></li></ul></li><li><a href=#shipping-the-component>Shipping the component</a><ul><li><a href=#signing>Signing</a></li><li><a href=#verification>Verification</a></li><li><a href=#transferring>Transferring</a></li></ul></li><li><a href=#deploying-the-component>Deploying the component</a><ul><li><a href=#bootstrapping-flux>Bootstrapping Flux</a></li><li><a href=#deploying-the-ocm-controller>Deploying the OCM Controller</a></li><li><a href=#reconciling-components>Reconciling Components</a></li><li><a href=#consuming-snapshots-via-flux>Consuming <code>Snapshots</code> via Flux</a></li></ul></li><li><a href=#wrapping-up>Wrapping Up</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#table-of-content>Table of content</a></li><li><a href=#requirements>Requirements</a></li><li><a href=#building-the-component>Building the component</a><ul><li><a href=#the-shape-of-things-to-come>The shape of things to come</a></li><li><a href=#setting-up-our-project>Setting up our project</a></li><li><a href=#adding-resources>Adding resources</a></li><li><a href=#inspecting-components>Inspecting Components</a></li></ul></li><li><a href=#shipping-the-component>Shipping the component</a><ul><li><a href=#signing>Signing</a></li><li><a href=#verification>Verification</a></li><li><a href=#transferring>Transferring</a></li></ul></li><li><a href=#deploying-the-component>Deploying the component</a><ul><li><a href=#bootstrapping-flux>Bootstrapping Flux</a></li><li><a href=#deploying-the-ocm-controller>Deploying the OCM Controller</a></li><li><a href=#reconciling-components>Reconciling Components</a></li><li><a href=#consuming-snapshots-via-flux>Consuming <code>Snapshots</code> via Flux</a></li></ul></li><li><a href=#wrapping-up>Wrapping Up</a></li></ul></nav></div></nav><h2 id=introduction>Introduction <a href=#introduction class=anchor aria-hidden=true>#</a></h2><p>This tutorial will demonstrate how get started with the Open Component Model & Flux.</p><p>We shall build a component to deliver the <a href=https://github.com/stefanprodan/podinfo><code>podinfo</code></a> application, which we will then deploy using OCM&rsquo;s Flux integration. Along the way, we&rsquo;ll demonstrate some of the useful features of OCM.</p><h2 id=table-of-content>Table of content <a href=#table-of-content class=anchor aria-hidden=true>#</a></h2><ul><li><a href=#requirements>Requirements</a></li><li><a href=#building-the-component>Building the component</a><ul><li><a href=#the-shape-of-things-to-come>The shape of things to come</a></li><li><a href=#setting-up-our-project>Setting up our project</a></li><li><a href=#adding-resources>Adding resources</a></li><li><a href=#inspecting-components>Inspecting Components</a></li></ul></li><li><a href=#shipping-the-component>Shipping the component</a><ul><li><a href=#signing>Signing</a></li><li><a href=#verification>Verification</a></li><li><a href=#transferring>Transferring</a></li></ul></li><li><a href=#deploying-the-component>Deploying the component</a><ul><li><a href=#bootstrapping-flux>Bootstrapping Flux</a></li><li><a href=#deploying-the-ocm-controller>Deploying the OCM Controller</a></li><li><a href=#reconciling-components>Reconciling Components</a></li><li><a href=#consuming-snapshots-via-flux>Consuming <code>Snapshots</code> via Flux</a></li></ul></li><li><a href=#wrapping-up>Wrapping Up</a></li></ul><h2 id=requirements>Requirements <a href=#requirements class=anchor aria-hidden=true>#</a></h2><ul><li><a href=https://github.com/open-component-model/ocm>OCM command line tool</a></li><li><a href=https://kubernetes.io/docs/reference/kubectl/>kubectl</a></li><li><a href=https://git-scm.com/downloads>git</a></li><li><a href=https://github.com/cli/cli>gh</a></li><li><a href=https://kind.sigs.k8s.io/docs/user/quick-start/#installation>kind</a></li><li><a href=https://fluxcd.io/flux/installation/#install-the-flux-cli>flux</a></li></ul><h2 id=building-the-component>Building the component <a href=#building-the-component class=anchor aria-hidden=true>#</a></h2><h3 id=the-shape-of-things-to-come>The shape of things to come <a href=#the-shape-of-things-to-come class=anchor aria-hidden=true>#</a></h3><p>Our component will consist of three resources:</p><ul><li>podinfo OCI image</li><li>Kubernetes manifest to create a podinfo deployment</li><li>configuration to enable updating our deployment using information from the OCM component descriptor</li></ul><p>Don&rsquo;t worry if some of the terminology is unfamiliar at this point, we will introduce concepts and terminology as we go.</p><h3 id=setting-up-our-project>Setting up our project <a href=#setting-up-our-project class=anchor aria-hidden=true>#</a></h3><p>Let&rsquo;s configure a workspace for developing our component:</p><p><code>mkdir podinfo-component && cd $_</code></p><p>OCM will store local artifacts and metadata in a <strong>component archive</strong>. We can use the <code>ocm</code> CLI to create the component archive:
<code>ocm create componentarchive github.com/acme/podinfo v1.0.0 --provider acme</code></p><p>As we can see above, the command <code>ocm create componentarchive</code> takes three parameters: the name of our component, it&rsquo;s version and the name of the component provider.</p><p>If we now examine the contents of our working directory, we can see that a new sub-directory has been created for the component archive:</p><pre><code class=language-shell>$ tree .
.
└── component-archive
    ├── blobs
    └── component-descriptor.yaml

2 directories, 1 files
</code></pre><p>This archive contains a directory for the blobs of local artifacts that we add to our component and a <code>component-descriptor.yaml</code> file. The component descriptor is a metadata file that holds information describing the entire surface of our component.</p><p>If we examine the file now we will see that it is empty apart from the basic metadata about our component; let&rsquo;s fix that.</p><h3 id=adding-resources>Adding resources <a href=#adding-resources class=anchor aria-hidden=true>#</a></h3><p><code>Resources</code> are an OCM concept that defines artifacts which are necessary to deploy our software. These artifacts can be things like OCI images, binaries, Helm charts, local files or directries, and so on.</p><p>To add our podinfo OCI image, we need to create a resource file describing the resource and how to access it:</p><pre><code class=language-shell>cat &gt; image_resource.yaml &lt;&lt; EOF
name: image
version: v6.2.0
type: ociImage
relation: external
access:
  type: ociArtifact
  imageReference: ghcr.io/stefanprodan/podinfo:6.2.0
EOF
</code></pre><p>With this file, we can use the ocm CLI to store the resource information in our component archive:</p><p><code>ocm add resource ./component-archive image_resource.yaml</code></p><p>Let&rsquo;s use the ocm CLI to verify that the resource has been successfully added:</p><pre><code class=language-shell>$ ocm get resources ./component-archive

NAME  VERSION IDENTITY TYPE     RELATION
image v6.2.0           ociImage external
</code></pre><p>Now that we&rsquo;ve successfully added an external resource, it&rsquo;s time to add something from the local filesystem.</p><p>The following command will generate a simple deployment file for podinfo:</p><pre><code class=language-shell>cat &gt; deployment.yaml &lt;&lt; EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: podinfo
  namespace: default
  labels:
    app: podinfo
spec:
  replicas: 1
  selector:
    matchLabels:
      app: podinfo
  template:
    metadata:
      labels:
        app: podinfo
    spec:
      containers:
      - image: noimage:v0.0.0 # we'll use localization later to correctly specify the image
        name: podinfo
        ports:
        - containerPort: 9898
          name: http
EOF
</code></pre><pre><code class=language-shell>cat &gt; deployment_resource.yaml &lt;&lt; EOF
name: deployment
version: v1.0.0
type: localBlob
input:
  type: file
  path: ./deployment.yaml
  compress: true
EOF
</code></pre><p>Again, we can use the ocm CLI to add the resource information in our component archive, just as we did above when we added the image:</p><p><code>ocm add resource ./component-archive deployment_resource.yaml</code></p><h3 id=inspecting-components>Inspecting Components <a href=#inspecting-components class=anchor aria-hidden=true>#</a></h3><p>Now if we inspect the resources associated with our component we can see the file resource is present with its name <code>deployment</code>:</p><pre><code class=language-shell>$ ocm get resources ./component-archive

NAME       VERSION IDENTITY TYPE     RELATION
deployment v1.0.0           file     local
image      v6.2.0           ociImage external
</code></pre><p>Additionally, if we examine the blobs directory we can see that our local file is now present here also:</p><pre><code class=language-shell>tree .
.
├── component-archive
│   ├── blobs
│   │   └── sha256.9d0f28a66f76a31d5d21ac96eb8d0ce34544e8804eaf5288cd43624467a25fef
│   └── component-descriptor.yaml
├── deployment.yaml
├── deployment_resource.yaml
└── image_resource.yaml

2 directories, 5 files
</code></pre><p>And if we examine the blob itself further we can see that it in fact contains our content (the deployment.yaml):</p><pre><code>$ cat ./component-archive/blobs/sha256.9d0f28a66f76a31d5d21ac96eb8d0ce34544e8804eaf5288cd43624467a25fef | gzip -d

apiVersion: apps/v1
kind: Deployment
metadata:
  name: podinfo
  labels:
    app: podinfo
spec:
  replicas: 1
  selector:
    matchLabels:
      app: podinfo
  template:
    metadata:
      labels:
        app: podinfo
    spec:
      containers:
      - image: noimage:v0.0.0 # we'll use localization later to correctly specify the image
        name: podinfo
        ports:
        - containerPort: 9898
          name: http
</code></pre><p>Finally, we will add a configuration file that will be used when we deploy our application in Kubernetes:</p><p>Create the config file:</p><pre><code>cat &gt; config.yaml &lt;&lt; EOF
apiVersion: config.ocm.software/v1alpha1
kind: ConfigData
metadata:
  name: ocm-config
localization:
- resource:
    name: image
    file: deployment.yaml
    image: spec.template.spec.containers[0].image
EOF
</code></pre><p>Create the resource file:</p><pre><code class=language-shell>cat &gt; config_resource.yaml &lt;&lt; EOF
name: config
version: v1.0.0
type: localBlob
input:
  type: file
  path: ./config.yaml
  compress: true
EOF
</code></pre><p>Add the resource to the component archive:
<code>ocm add resource ./component-archive config_resource.yaml</code></p><p>Now let&rsquo;s examine the final component:</p><pre><code class=language-shell>$ ocm get resources ./component-archive

NAME       VERSION IDENTITY TYPE     RELATION
config     v1.0.0           file     local
deployment v1.0.0           file     local
image      v6.2.0           ociImage external
</code></pre><p>Now our component is ready to be shipped. In the next section, we shall examine how to securely transfer our component to a remote repository.</p><h2 id=shipping-the-component>Shipping the component <a href=#shipping-the-component class=anchor aria-hidden=true>#</a></h2><p>To deliver our component, we have a number of options. In this introductory guide, will we deliver the component to an OCI repository. The OCM cli will pickup credentials from the default docker credentials chain, so we can get started by logging into our registry of choice (in this case GitHub container registry, <code>ghcr.io</code>):</p><p><code>echo $GITHUB_PAT_TOKEN | docker login ghcr.io -u $GITHUB_USER --password-stdin</code></p><h3 id=signing>Signing <a href=#signing class=anchor aria-hidden=true>#</a></h3><p>To ensure our component is securely delivered, we can use OCM&rsquo;s signing features. To get started quickly, OCM cli can generate signing keys for us (but we could also bring our own):</p><p><code>ocm create rsakeypair</code></p><p>This will create a public and private key (by default named <code>rsa.priv</code> and <code>rsa.pub</code>) in our working directory.</p><p>We can sign our component using these keys. OCM allows for multiple signers so we provide a name using the <code>--signature</code> flag to identify our signature.</p><p><code>ocm sign component --signature alice --private-key rsa.priv --public-key rsa.pub ./component-archive</code></p><h3 id=verification>Verification <a href=#verification class=anchor aria-hidden=true>#</a></h3><p>We can also verify the component using the ocm CLI:</p><p><code>ocm verify component -s alice -k rsa.pub ./component-archive</code></p><h3 id=transferring>Transferring <a href=#transferring class=anchor aria-hidden=true>#</a></h3><p>Now we can transfer our component to an OCI repository:</p><p><code>ocm transfer component ./component-archive ghcr.io/$GITHUB_USER</code></p><p>Now that our component has been transferred, let&rsquo;s verify the signatures once again, this time using the remote OCM repository:</p><p><code>ocm verify component -s alice -k rsa.pub --repo ghcr.io/$GITHUB_USER github.com/acme/podinfo</code></p><h2 id=deploying-the-component>Deploying the component <a href=#deploying-the-component class=anchor aria-hidden=true>#</a></h2><p>We&rsquo;ll deploy our component on a Kind cluster using Flux.</p><p>First of all, let&rsquo;s create the cluster:</p><p><code>kind</code></p><h3 id=bootstrapping-flux>Bootstrapping Flux <a href=#bootstrapping-flux class=anchor aria-hidden=true>#</a></h3><p>Flux requires a git repository, so let&rsquo;s configure our working directory as a git repository:</p><pre><code class=language-shell>git init
echo rsa.priv &gt;&gt; .gitignore
mkdir ./clusters &amp;&amp; touch ./clusters/kind/.keep
mkdir ./components  &amp;&amp; touch ./components/.keep
git add .gitignore ./clusters/kind/ ./components
git commit -m &quot;project setup&quot;
</code></pre><p>We can use the <code>gh</code> cli to quickly initialise a GitHub repository:</p><p><code>gh repo create</code></p><p>With all this in place, it&rsquo;s time to bootstrap flux:</p><p><code>flux bootstrap github --owner $GITHUB_USER --repository $GITHUB_REPOSITORY --path ./clusters/kind --personal</code></p><p>Flux will install some resources in the cluster and commit manifests to our repository so that it can manage itself. Once Flux has finished bootstrapping we should ensure our local git tree is in sync with the remote:</p><p><code>git pull</code></p><p>We&rsquo;ll use a Kustomization to reconcile any resources found in the <code>./components</code> directory:</p><pre><code class=language-shell>echo &gt; ./clusters/kind/components_kustomization.yaml &lt;&lt;EOF
apiVersion: kustomize.toolkit.fluxcd.io/v1beta2
kind: Kustomization
metadata:
  name: components
  namespace: ocm-system
spec:
  interval: 1m0s
  prune: true
  targetNamespace: default
  sourceRef:
    kind: OCIRepository
    name: podinfo
  path: ./components
EOF
</code></pre><p>Create this file, then commit, push and ensure Flux has reconciled the resource:</p><pre><code class=language-shell>git add ./clusters/kind/components_kustomization.yaml
git commit -m &quot;add components kustomization&quot;
git push

# trigger an immediate reconciliation of our repo
flux reconcile source git flux-system

# view kustomizations and their status
flux get kustomizations
</code></pre><h3 id=deploying-the-ocm-controller>Deploying the OCM Controller <a href=#deploying-the-ocm-controller class=anchor aria-hidden=true>#</a></h3><p>We&rsquo;ll use the OCM controller to help manage the lifecycle of an application with GitOps. Here is a diagram outlining what we will be building:</p><p><img class="img-fluid lazyload blur-up" src=/images/getting-started-flux-figure-1.png alt=Architecture></p><p>The items outlined in purple and green are the resources we will create using GitOps; everything else shall be generated automatically for us.</p><p>The controller requires a few secrets in order to retrieve components from our OCI registry and to verify component signatures, let&rsquo;s set those up first:</p><pre><code class=language-shell>kubectl create ns ocm-system

kubectl create secret docker-registry -n ocm-system regcred \
    --docker-server=ghcr.io \
    --docker-username=$GITHUB_USER
    --docker-password=$GITHUB_PAT \
    --docker-email=$GITHUB_USER_EMAIL

kubectl create secret generic -n ocm-system creds --from-literal=username=$GITHUB_USER --from-literal=password=$GITHUB_PAT

kubectl create secret generic -n ocm-system alice-publickey --from-file=alice=rsa.pub
</code></pre><blockquote><p><strong>note</strong> Currently we require OCI registry credentials to be configured twice, this is a known issue and will be resolved in a future update to the ocm-controller</p></blockquote><pre><code>gh repo clone open-component-model/ocm-controller
cd ocm-controller
make deploy
</code></pre><h3 id=reconciling-components>Reconciling Components <a href=#reconciling-components class=anchor aria-hidden=true>#</a></h3><p>Next up we create a <code>ComponentVersion</code> custom resource in order to reconcile the component from the registry:</p><pre><code>echo &gt; ./components/componentversion.yaml &lt;&lt;EOF
apiVersion: delivery.ocm.software/v1alpha1
kind: ComponentVersion
metadata:
  name: podinfo
  namespace: ocm-system
spec:
  interval: 10m0s
  name: github.com/acme/podinfo
  version:
    semver: v1.0.0
  repository:
    url: ghcr.io/$GITHUB_USER
    secretRef:
      name: creds
  verify:
  - name: phoban01
    publicKey:
      secretRef:
        name: alice-publickey
EOF
</code></pre><p>Again after creating the file, we commit, push and ensure Flux has reconciled the resource:</p><pre><code class=language-shell>git add ./components/componentversion.yaml
git commit -m &quot;add componentversion&quot;
git push

# trigger an immediate reconciliation of our repo
flux reconcile source git flux-system

# view the componentversion
kubectl get componentversion podinfo
</code></pre><p>We&rsquo;ll use the <code>Resource</code> custom resource to extract the deployment manifests from our component:</p><pre><code>echo &gt; ./components/resource.yaml &lt;&lt;EOF
apiVersion: delivery.ocm.software/v1alpha1
kind: Resource
metadata:
  name: podinfo-deployment
  namespace: ocm-system
spec:
  interval: 10m0s
  componentVersionRef:
    name: podinfo
    namespace: ocm-system
  resource:
    name: deployment
  snapshotTemplate:
    name: podinfo-deployment
    tag: latest
EOF
</code></pre><p>Commit this file to git and follow the push and reconcile pattern seen previously.</p><p>When the resource has been created, we&rsquo;ll find a new snapshot in the cluster:</p><p><code>kubectl get snapshot podinfo-deployment</code></p><p>A <code>Snapshot</code> is a Flux compatible OCI image that&rsquo;s stored in a OCI-registry managed by the OCM controller. It allows us to transform resources from a component and to deploy them with flux.</p><p>One type of transformation we can apply is to set the correct image url in our deployment manifests based on the location of a component resource. This becomes particularly important if we are working in a heavily regulated or air-gapped environment. We call this process of configuring the component for a local environment <strong>localization</strong>.</p><p>To perform this operation, we will process the <code>Snapshot</code> that has been created by the <code>Resource</code> and merge it with configuration rules supplied via the <code>ConfigData</code> object we added to our component in an earlier step. All of this is done with a <code>localization</code>custom resource:</p><pre><code>
echo &gt; ./components/localization.yaml &lt;&lt;EOF
apiVersion: delivery.ocm.software/v1alpha1
kind: Localization
metadata:
  name: podinfo
  namespace: ocm-system
spec:
  interval: 1m0s
  componentVersionRef:
    name: podinfo
    namespace: ocm-system
  source:
    sourceRef:
      kind: Snapshot
      name: podinfo-deployment
      namespace: ocm-system
  configRef:
    resource:
      name: config
  snapshotTemplate:
    name: podinfo-deployment-localized
    tag: latest
EOF
</code></pre><p>Commit, push and reconcile the <code>Localization</code> custom resource. Once it has done it&rsquo;s thing, we should see two snapshots:</p><pre><code class=language-shell>$ kubectl get snapshots

NAME                            AGE
podinfo-deployment              5m20s
podinfo-deployment-localized    1m2s
</code></pre><p><code>Localization</code> is the only transformation step we will perform in this simple scenario. For now let&rsquo;s move on and create a couple of Flux manifests so that we can apply the contents of our <code>Snapshot</code> to the cluster:</p><h3 id=consuming-snapshots-via-flux>Consuming <code>Snapshots</code> via Flux <a href=#consuming-snapshots-via-flux class=anchor aria-hidden=true>#</a></h3><p>We&rsquo;ll create a Flux <code>OCIRepository</code> in order to retrieve the snapshot from the in-cluster registry:</p><pre><code>echo &gt; ./components/ocirepo.yaml &lt;&lt;EOF
apiVersion: source.toolkit.fluxcd.io/v1beta2
kind: OCIRepository
metadata:
  name: podinfo
  namespace: ocm-system
spec:
  interval: 1m0s
  url: oci://$SNAPSHOT
  insecure: true
  ref:
    tag: latest
EOF
</code></pre><p>Then we will create a Flux <code>Kustomization</code> to apply the contents of the snapshot to the cluster:</p><pre><code>echo &gt; ./components/kustomization.yaml &lt;&lt;EOF
apiVersion: kustomize.toolkit.fluxcd.io/v1beta2
kind: Kustomization
metadata:
  name: podinfo
  namespace: ocm-system
spec:
  interval: 1m0s
  prune: true
  targetNamespace: default
  sourceRef:
    kind: OCIRepository
    name: podinfo
  path: ./
EOF
</code></pre><p>Now we commit these two files, push and wait for Flux to reconcile the localized podinfo application.</p><pre><code class=language-shell>git add ./components/ocirepo.yaml ./components/kustomization.yaml
git commit -m &quot;add flux manifests to podinfo component&quot;
git push

flux reconcile source git flux-system

kubectl get deployment podinfo -n default
</code></pre><h2 id=wrapping-up>Wrapping Up <a href=#wrapping-up class=anchor aria-hidden=true>#</a></h2><p>That&rsquo;s it for our introductory tutorial on OCM and Flux. We shall cover more advanced scenarios in future guides.</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a href=/docs/guides/structuring-software-with-ocm/><div class="card my-1"><div class="card-body py-2">&larr; Structuring Software with OCM</div></div></a><a class=ms-auto href=/docs/installation/><div class="card my-1"><div class="card-body py-2">Installation &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class="row justify-content-center"><div class=col-lg-12><p class=text-center><small>© Copyright 2022, SAP SE and Open Component Model Contributors | <a href=/privacy-policy/>Privacy Policy</a> | <a href=https://www.sap.com/corporate/en/legal/terms-of-use.html>Terms of Use</a> | <a href=/legal>Legal</a></small></p></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51+L6gymJi4Qg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.56a414730f1135fe77b5ea30bf74a2cc4101a6f386e85e5b789c800570cc33d33054000f45932c053a59b41018f72687867254a80e1b9710671852492533162f.js integrity="sha512-VqQUcw8RNf53teowv3SizEEBpvOG6F5beJyABXDMM9MwVAAPRZMsBTpZtBAY9yaHhnJUqA4blxBnGFJJJTMWLw==" crossorigin=anonymous defer></script>
<script src=/main.min.867372088b3d9d28e68d38f8a8365d28934d875dc849d445fe06cc02a75d29286fa27e6ab5f9820c0d5bdcf90711a1ee7a4d89a7e0bee27ebb521ecd1c1f0175.js integrity="sha512-hnNyCIs9nSjmjTj4qDZdKJNNh13ISdRF/gbMAqddKShvon5qtfmCDA1b3PkHEaHuek2Jp+C+4n67Uh7NHB8BdQ==" crossorigin=anonymous defer></script></body></html>